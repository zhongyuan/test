<div>
<a href = "../../../COS Cplusplus Development.html">COS Cplusplus Development</a>&gt;<a href = "../../Developer Guides.html">Developer Guides</a>&gt;<a href = "../Data storage.html">Data storage</a>&gt;
</div>
<h1>ApplicationPreferences</h1>
<h2>Saving Key-Value Sets</h2>
<p>if you have a relatively small collection of key-values that you'd like to save, you should use the ApplicationPreferences APIs.</p>
<p>A ApplicationPreferences object points to a file containing key-value pairs and provides simple methods to read and write them.</p>
<blockquote>
<p>NOTE: Note: The ApplicationPreferences APIs are only for reading and writing key-value pairs and you should not confuse them with the Preference APIs, which help you build a user interface for your app settings (although they use ApplicationPreferences as their implementation to save the app settings).</p>
</blockquote>
<h3>Get a ApplicationPreferences object for your application.</h3>
<p>To get a ApplicationPreferences object for your application, use one of two APIs:</p>
<ol>
<li>
<p><strong>Context::getApplicationPreferencesN(int permission)</strong> - Use this if you need only one preferences files for your whole application package. The ApplicationPreferences will store undaer /data/data/your_package_name/shared_prefs/your_package_name.xml</p>
</li>
<li>
<p><strong>Context::getPageApplicationPreferencesN(Page *page, int permission)</strong> - Use this if you need to separate preferences files for your Page. The ApplicationPreferences will store undaer /data/data/your_package_name/shared_prefs/page_name.xml</p>
</li>
</ol>
<h5>The permission is as following.</h5>
<ul>
<li>
<p><strong>MODE_SELF</strong> - preference permission. The created file can only be accessed by the calling application.</p>
</li>
<li>
<p><strong>MODE_ALL_READ</strong> - preference permission. The created file can only be writed by the calling application, but can be read by other application under the same package (.pkg)</p>
</li>
<li>
<p><strong>MODE_ALL_WRITE</strong> - preference permission. Every application in the same package can read/write.</p>
</li>
</ul>
<h5>The exampe code to get a package level ApplicationPreferences:</h5>
<pre><code>    // new Context instance
    Context* context = new Context(this);

    // Get ApplicationPreferences instance
    content::ApplicationPreferences* preference =
        context-&gt;getApplicationPreferencesN(content::ApplicationPreferences::MODE_ALL_WRITE);
</code></pre>
<h5>And The exampe code to get a page level ApplicationPreferences:</h5>
<pre><code>    // new Context instance
    Context* context = new Context(this);

    // Get ApplicationPreferences instance
    content::ApplicationPreferences* preference =
        context-&gt;getPageApplicationPreferencesN(this, content::ApplicationPreferences::MODE_ALL_WRITE);
</code></pre>
<h3>To write ApplicationPreferences as following two steps:</h3>
<h5>1. Add values with ApplicationPreferences put APIs such as:</h5>
<ul>
<li>void putBool(const base::String &amp;key, bool value);</li>
<li>void putInt(const base::String &amp;key, int32_t value);</li>
<li>void putLong(const base::String &amp;key, int64_t value);</li>
<li>void putFloat(const base::String &amp;key, float value);</li>
<li>void putDouble(const base::String &amp;key, double value);</li>
<li>void putString(const base::String &amp;key, const base::String &amp;value);</li>
</ul>
<h5>2. Save new values with ApplicationPreferences API save():</h5>
<ul>
<li>bool save();</li>
</ul>
<h6>Example:</h6>
<pre><code>    // Get ApplicationPreferences instance
    content::ApplicationPreferences* preference =
        context-&gt;getApplicationPreferencesN(content::ApplicationPreferences::MODE_ALL_WRITE);

    // Set values
    preference-&gt;setInt("int32_t_key", 1000);
    preference-&gt;setBool("bool_key", true);
    preference-&gt;setFloat("float_key", 0.123);
    preference-&gt;setString("string_key", "this is String value");

    // Save modify to persistent storage.
    preference-&gt;save();
</code></pre>
<h3>To read ApplicationPreferences:</h3>
<h5>You can read values with ApplicationPreferences get APIs such as:</h5>
<ul>
<li>bool getBool(const base::String &amp;key, bool defaultValue) const;</li>
<li>int32_t getInt(const base::String &amp;key, int32_t defaultValue) const;</li>
<li>int64_t getLong(const base::String &amp;key, int64_t defaultValue) const;</li>
<li>float getFloat(const base::String &amp;key, float defaultValue) const;</li>
<li>double getDouble(const base::String &amp;key, double defaultValue) const;</li>
<li>base::String getString(const base::String &amp;key, const base::String &amp;defaultValue) const;</li>
<li>base::HashMap<base::String, base::String> getAllAsString() const;</li>
</ul>
<h5>Example:</h5>
<pre><code>    // Get ApplicationPreferences instance
    content::ApplicationPreferences* preference =
        context-&gt;getApplicationPreferencesN(content::ApplicationPreferences::MODE_ALL_WRITE);

    // Get values
    int32_t int32_t_value = preference-&gt;getInt("int32_t_key", 0);
    bool bool_value = preference-&gt;getBool("bool_key", 0.0);
    float float_value = preference-&gt;getFoat("float_key", 0.0);
    gaia::base::String string_value = preference-&gt;getString("string_key", "default value");
</code></pre>
<h3>Check if the key contains in this ApplicationPreferences.</h3>
<h5>ApplicationPreferences also provide the API to check if the key contains in this ApplicationPreferences or not.</h5>
<ul>
<li>bool contains(const base::String &amp;key) const;</li>
</ul>
<h5>Example:</h5>
<pre><code>    // Get ApplicationPreferences instance
    content::ApplicationPreferences* preference =
        context-&gt;getApplicationPreferencesN(content::ApplicationPreferences::MODE_ALL_WRITE);

    bool is_contains = preference-&gt;contains("int32_t_key");
</code></pre>
<h3>To remove ApplicationPreferences as following two steps:</h3>
<h5>1. Remove values with ApplicationPreferences API remove():</h5>
<ul>
<li>bool remove(const base::String &amp;key);</li>
</ul>
<h5>2. Save the removed change with ApplicationPreferences API save():</h5>
<ul>
<li>bool save();</li>
</ul>
<h6>Example:</h6>
<pre><code>    // Get ApplicationPreferences instance
    content::ApplicationPreferences* preference =
        context-&gt;getApplicationPreferencesN(content::ApplicationPreferences::MODE_ALL_WRITE);

    // Check if contains key first
    if (preference-&gt;contains("int32_t_key")) {
        // Remove value

        preference-&gt;remove("int32_t_key");
        // Save modify to persistent storage.
        preference-&gt;save();
    }
</code></pre>
<h3>Here is the full example shows how to use the ApplicationPreferences.</h3>
<pre><code>    MyPage::onInit(Persistence* const savedInstanceState) {
         // new Context instance
         Context* context = new Context(this);

         // Get ApplicationPreferences instance
         content::ApplicationPreferences* preference =
             context-&gt;getApplicationPreferencesN(content::ApplicationPreferences::MODE_ALL_WRITE);

         // Set values
         preference-&gt;setInt("int32_t_key", 1000);
         preference-&gt;setBool("bool_key", true);
         preference-&gt;setFloat("float_key", 0.123);
         preference-&gt;setString("string_key", "this is String value");

         // Save modify to persistent storage.
         preference-&gt;save();

         // Get values
         int32_t int32_t_value = preference-&gt;getInt("int32_t_key", 0);
         bool bool_value = preference-&gt;getBool("bool_key", 0.0);
         float float_value = preference-&gt;getFoat("float_key", 0.0);
         gaia::base::String string_value = preference-&gt;getString("string_key", "default value");

         // Check if contains key first
         if (preference-&gt;contains("int32_t_key")) {
             // Remove value
             preference-&gt;remove("int32_t_key");

             // Save modify to persistent storage.
             preference-&gt;save();
         }
     }
</code></pre>