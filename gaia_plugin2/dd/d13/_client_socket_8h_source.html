<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>

<title>/home/vilon_tao/gaia/sdk/include/gaia/net/ClientSocket.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="../../dynsections.js"></script>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../dir_0a2191738eaf1a89d8dba65a5e0e62dd.html">include</a>      </li>
      <li class="navelem"><a class="el" href="../../dir_18fe6922e29c45285b63ff54cf62344c.html">gaia</a>      </li>
      <li class="navelem"><a class="el" href="../../dir_cee7a6990ad1189ecb0d51807df25e86.html">net</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ClientSocket.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d13/_client_socket_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright for gaia</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef INCLUDE_GAIA_NET_CLIENTSOCKET_H_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define INCLUDE_GAIA_NET_CLIENTSOCKET_H_</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;<a class="code" href="../../d4/de6/_i_client_socket_listener_8h.html">gaia/net/IClientSocketListener.h</a>&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;<a class="code" href="../../d2/d53/_i_p_address_8h.html">gaia/net/IPAddress.h</a>&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;<a class="code" href="../../d1/d88/_net_types_8h.html">gaia/net/NetTypes.h</a>&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="keyword">namespace </span>gaia {
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">namespace </span>base {
<a name="l00016"></a>00016 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span>Array;
<a name="l00017"></a>00017 <span class="keyword">class </span>ByteArray;
<a name="l00018"></a>00018 }
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">namespace </span>net {
<a name="l00021"></a>00021 <span class="keyword">class </span>IPEndPoint;
<a name="l00022"></a>00022 <span class="keyword">class </span>GaiaChromiumBridge;
<a name="l00023"></a>00023 
<a name="l00043"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html">00043</a> <span class="keyword">class </span><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html" title="Access IP network.">ClientSocket</a> {
<a name="l00044"></a>00044   <span class="keyword">public</span>:
<a name="l00045"></a>00045   <span class="keyword">class </span>Worker;
<a name="l00046"></a>00046   <span class="keyword">class </span>WorkerHolder;
<a name="l00052"></a>00052   <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a96ad30c9e0ccfd0cd76d21424cbccd25" title="Create a socket in default address domain.">ClientSocket</a>();
<a name="l00053"></a>00053 
<a name="l00066"></a>00066   <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a96ad30c9e0ccfd0cd76d21424cbccd25" title="Create a socket in default address domain.">ClientSocket</a>(<a class="code" href="../../da/db9/namespacegaia_1_1net.html#a066c385415fdfe452c54c643e175a340">NetAddressFamily</a> addrFamily, <a class="code" href="../../da/db9/namespacegaia_1_1net.html#afc5b7abaecd938ee04b5d8bb63751963">NetSocketType</a> type, int32_t proto);
<a name="l00067"></a>00067   <span class="comment">// IPv6 may not supported in this version.</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="keyword">virtual</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#ae2de20699986d2f855e29cd8ab7aece8">~ClientSocket</a>();
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="comment">// Common function of all-type of socket /////////////////////////////////////</span>
<a name="l00072"></a>00072 
<a name="l00082"></a>00082   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a7649d0a27619cb6d55b6c730028e0881" title="set if this socket is blocking mode.">setBlock</a>(<span class="keywordtype">bool</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a621e73b2067eb58420858c4b22116b64" title="Return true if this ClientSocket is in blocking-mode.">isBlock</a>);
<a name="l00083"></a>00083 
<a name="l00090"></a>00090   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a621e73b2067eb58420858c4b22116b64" title="Return true if this ClientSocket is in blocking-mode.">isBlock</a>();
<a name="l00091"></a>00091 
<a name="l00097"></a>00097   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="../../d2/db0/classgaia_1_1base_1_1_array.html">gaia::base::Array&lt;IPEndPoint&gt;</a>&amp; <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#acf038c1c096f505489d130ecd27d2e03" title="get peer&#39;s IPEndPoint of this socket.">getPeerEndPoints</a>() <span class="keyword">const</span>;
<a name="l00098"></a>00098 
<a name="l00104"></a>00104   <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="../../db/d4c/classgaia_1_1net_1_1_i_p_end_point.html" title="IPEndPoint describes an end point by IP and Port.">IPEndPoint</a>&amp; <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a4875b90888680b9c93612bdee0dcd3a2" title="get local IPEndPoint of this socket.">getLocalEndPoint</a>() <span class="keyword">const</span>;
<a name="l00105"></a>00105 
<a name="l00126"></a>00126   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a45c29690f18666485ab7ec98eba740f6" title="Gets an option of the socket.">getOption</a>(<a class="code" href="../../da/db9/namespacegaia_1_1net.html#a7711771e72ccce4eb18a98e28ae55b57" title="Defines the socket configuration option names.">SocketOptionName</a> optName, int32_t* optValue);
<a name="l00127"></a>00127 
<a name="l00145"></a>00145   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#ad4dbb49941979655405231cbaa6e715d" title="Change option of socket.">setOption</a>(<a class="code" href="../../da/db9/namespacegaia_1_1net.html#a7711771e72ccce4eb18a98e28ae55b57" title="Defines the socket configuration option names.">SocketOptionName</a> optName, int32_t value);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="comment">// Connection-oriented IO functions //////////////////////////////////////////</span>
<a name="l00148"></a>00148 
<a name="l00156"></a>00156   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#ae54977a1f68249208f9d71ee0b3f8e49" title="Establish a connection to specified end point for a connect-oriented socket.">connect</a>(<span class="keyword">const</span> <a class="code" href="../../db/d4c/classgaia_1_1net_1_1_i_p_end_point.html" title="IPEndPoint describes an end point by IP and Port.">IPEndPoint</a>&amp; targetEndPoint);
<a name="l00157"></a>00157 
<a name="l00163"></a>00163   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a1c93a4feee51d9fcfd526c82fb8097bc" title="Return if this socket is connected to a peer.">isConnected</a>() <span class="keyword">const</span>;
<a name="l00164"></a>00164 
<a name="l00172"></a>00172   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#aeb0aedf2fae391173b5d323fbd57f07a" title="Closes this socket.">close</a>();
<a name="l00173"></a>00173 
<a name="l00184"></a>00184   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a93715fc58114142b5d82923afb19ae1d" title="receive data and write to buffer.">receive</a>(<a class="code" href="../../d0/d04/classgaia_1_1base_1_1_byte_array.html">gaia::base::ByteArray</a>* buffer,
<a name="l00185"></a>00185                          <span class="keywordtype">size_t</span>* receivedLength);
<a name="l00186"></a>00186 
<a name="l00196"></a>00196   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a8c54af70bc96b9e9f2023a8ea1ed8fe1" title="send data to remote host.">send</a>(<span class="keyword">const</span> <a class="code" href="../../d0/d04/classgaia_1_1base_1_1_byte_array.html">gaia::base::ByteArray</a>&amp; buffer,
<a name="l00197"></a>00197                       <span class="keywordtype">size_t</span>* sentLength);
<a name="l00198"></a>00198 
<a name="l00199"></a>00199   <span class="comment">// Listener //////////////////////////////////////////////////////////////////</span>
<a name="l00200"></a>00200 
<a name="l00209"></a>00209   <span class="keyword">virtual</span> <a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a4d7a1674453f989edf8c3410d8701cb5" title="Set a listener to the socket.">setSocketListener</a>(<a class="code" href="../../df/d12/classgaia_1_1net_1_1_i_client_socket_listener.html" title="IClientSocketListener handles Socket callback.">IClientSocketListener</a>* listener);
<a name="l00210"></a>00210 
<a name="l00218"></a>00218   <span class="keyword">virtual</span> <a class="code" href="../../df/d12/classgaia_1_1net_1_1_i_client_socket_listener.html" title="IClientSocketListener handles Socket callback.">IClientSocketListener</a>* <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a3d47b2addbb0935556df69009722e212" title="Obtain a listener that is set to the socket.">getSocketListener</a>();
<a name="l00219"></a>00219 
<a name="l00220"></a>00220   <span class="keyword">protected</span>:
<a name="l00224"></a>00224   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a95c12f9c117e72c0d0ec6978e3066dfc" title="Update endpoint information after a connection is established.">updateEndPoints</a>(<a class="code" href="../../d2/db0/classgaia_1_1base_1_1_array.html">gaia::base::Array&lt;IPEndPoint&gt;</a>* peer,
<a name="l00225"></a>00225                        <a class="code" href="../../db/d4c/classgaia_1_1net_1_1_i_p_end_point.html" title="IPEndPoint describes an end point by IP and Port.">IPEndPoint</a>* local);
<a name="l00226"></a>00226 
<a name="l00230"></a>00230   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a8ff6dd7539a48e7e966f7e2638df6fd9" title="Notify listener when the connection is established.">notifyConnectSuccess</a>();
<a name="l00231"></a>00231 
<a name="l00232"></a>00232   <span class="keyword">private</span>:
<a name="l00233"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#aff88f97e95c12e7b7ae8e846e214b032">00233</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#aff88f97e95c12e7b7ae8e846e214b032">GaiaChromiumBridge</a>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#ac0f04cdb41d3b412a7efc18c4c7af8de">handleError</a>(<a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> r);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#ad654b76b26727cfc20642dd1b8807ef1">notifyError</a>(<a class="code" href="../../da/db9/namespacegaia_1_1net.html#ad03a944e07643a64d69d3641b3281cd5" title="Enumeration of network-related error code.">RESULT</a> r);
<a name="l00238"></a>00238   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a199c6ab831d8ad5442934dbb92fdc019">notifyWrite</a>(<span class="keywordtype">size_t</span> sentLength);
<a name="l00239"></a>00239   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a18368821dfff76656f15620914f51f80">notifyRead</a>(<span class="keywordtype">size_t</span> receivedLength);
<a name="l00240"></a>00240   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a5d6d7b79e08094ee7431f32c8553a092">notifyClosed</a>(<a class="code" href="../../da/db9/namespacegaia_1_1net.html#a75ad55a7b5a01844e9a1732e89020cba" title="Defines a socket closed reason.">SocketCloseReason</a> r);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   <span class="keywordtype">void</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a924f5500e87056f25f78ed20157198c8">setWorkerHolder</a>(ClientSocket::WorkerHolder* wh);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="comment">// Fields</span>
<a name="l00245"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a3d775223ddf0b9e2b193c38a4956f455">00245</a>   ClientSocket::WorkerHolder* <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a3d775223ddf0b9e2b193c38a4956f455">mpWorkerHolder</a>;
<a name="l00246"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a1ade6e1112ee9fdf8038625915b216d5">00246</a>   <a class="code" href="../../df/d12/classgaia_1_1net_1_1_i_client_socket_listener.html" title="IClientSocketListener handles Socket callback.">IClientSocketListener</a>* <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a1ade6e1112ee9fdf8038625915b216d5">mpListener</a>;
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a83610856ad206c74e1e5c51127019ee6">00248</a>   int32_t <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a83610856ad206c74e1e5c51127019ee6">mResult</a>;  <span class="comment">// Store last result in asynchronous mode.</span>
<a name="l00249"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a3684133253b73ffa582e97cf13e54717">00249</a>   int32_t <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a3684133253b73ffa582e97cf13e54717">mProtocol</a>;  <span class="comment">// Protocol to create socket.</span>
<a name="l00250"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a0fe504e59f1ac2004bb6ba6fd88bef93">00250</a>   <span class="keywordtype">bool</span> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a0fe504e59f1ac2004bb6ba6fd88bef93">mIsBlocking</a>;
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a014d627574a7ebe7c7e628300650723c">00252</a>   pthread_t <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a014d627574a7ebe7c7e628300650723c">mThread</a>;
<a name="l00253"></a>00253 
<a name="l00254"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#acc23e790f84aa578281cac104d730e65">00254</a>   <a class="code" href="../../d2/db0/classgaia_1_1base_1_1_array.html">gaia::base::Array&lt;IPEndPoint&gt;</a>* <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#acc23e790f84aa578281cac104d730e65">mpPeerEndPoints</a>;
<a name="l00255"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a9088f78579a3d5165b104670eb6511ba">00255</a>   <a class="code" href="../../db/d4c/classgaia_1_1net_1_1_i_p_end_point.html" title="IPEndPoint describes an end point by IP and Port.">IPEndPoint</a>* <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a9088f78579a3d5165b104670eb6511ba">mpLocalEndPoint</a>;
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a9b503391e1b9a02dbfc8f642b1a7cb77">00257</a>   <a class="code" href="../../da/db9/namespacegaia_1_1net.html#a066c385415fdfe452c54c643e175a340">NetAddressFamily</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a9b503391e1b9a02dbfc8f642b1a7cb77">mAddressFamily</a>;
<a name="l00258"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#af92b5b4b3eb182c31e975ea31a2a5054">00258</a>   <a class="code" href="../../da/db9/namespacegaia_1_1net.html#afc5b7abaecd938ee04b5d8bb63751963">NetSocketType</a> <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#af92b5b4b3eb182c31e975ea31a2a5054">mType</a>;
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a540f11455f41fb7579b06180e4096f9c">00260</a>   int32_t <a class="code" href="../../d8/df3/classgaia_1_1net_1_1_client_socket.html#a540f11455f41fb7579b06180e4096f9c">mErrorCode</a>;
<a name="l00261"></a>00261 };  <span class="comment">// class</span>
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="preprocessor">#endif  // INCLUDE_GAIA_NET_CLIENTSOCKET_H_</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 25 2013 11:23:19 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
